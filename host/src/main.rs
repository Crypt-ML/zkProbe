// These constants represent the RISC-V ELF and the image ID generated by risc0-build.
// The ELF is used for proving and the ID is used for verification.
use methods::{ZKSECURE_GUEST_ELF, ZKSECURE_GUEST_ID};
use risc0_zkvm::{default_prover, ExecutorEnv};

const D: usize = 640;

fn main() {
    // Initialize tracing. In order to view logs, run `RUST_LOG=info cargo run`
    tracing_subscriber::fmt()
        .with_env_filter(tracing_subscriber::filter::EnvFilter::from_default_env())
        .init();

    // An executor environment describes the configurations for the zkVM
    // including program inputs.
    // A default ExecutorEnv can be created like so:
    // `let env = ExecutorEnv::builder().build().unwrap();`
    // However, this `env` does not have any inputs.
    //
    // To add guest input to the executor environment, use
    // ExecutorEnvBuilder::write().
    // To access this method, you'll need to use ExecutorEnv::builder(), which
    // creates an ExecutorEnvBuilder. When you're done adding input, call
    // ExecutorEnvBuilder::build().

    let input: Vec<i16> = vec![
        -28010, 18384, 10268, 7295, 1673, 16746, 4090, 2058, -10022, 15223, 5182, 22175, -311,
        -7805, -32767, -4592, -32767, -4094, 10294, 9003, -24360, 5131, -12923, 10355, 1050,
        -22961, 816, 29578, -1649, 2886, -2625, 1271, 3708, 32767, -15916, -3504, -32767, -12037,
        -9871, 14205, -6026, -18127, 2083, -3628, 15923, -2510, 1100, 7898, -26233, -18200, 10197,
        21071, -8048, 6540, 2434, 13394, 10685, -32767, -1879, 4126, 15127, -32767, 1132, -27169,
        14811, -32767, 13816, -6243, 32767, -4472, -1209, -1781, 6298, 19422, 95, 15240, -7806,
        5706, -20450, 6707, 9132, -13326, -9243, 17555, -2235, -780, 32767, 32767, 32767, 31155,
        14433, -8835, 7155, 32767, -6787, -6309, 16725, -22801, 22368, 25091, -32767, 2530, -25017,
        -16526, -32767, -4057, -12917, -32767, 1958, -23174, -5474, 1112, 15604, 55, -3811, -3134,
        -3442, -7600, -11220, -16217, 23907, 4809, 32767, 12797, 32767, -7233, -5370, 3052, -6112,
        -12835, 16333, 794, -6340, -6530, 32767, 482, -12865, -2000, 17517, 24086, -18276, 7931,
        18525, -4838, 22692, 3487, 27458, 6016, -32767, 2913, -899, 18350, -1475, -1791, -32767,
        -11967, -5591, 15692, -28657, -5828, 20781, -29202, -13498, 32767, 12046, -6417, 11206,
        -22777, 32767, 156, 32767, 7117, -1717, -32767, 1021, 10312, 32767, -28650, -9601, 8225,
        8124, -7923, -1517, 32767, -32767, 9287, 26972, -32767, 10396, -18918, -15031, 13837,
        -15058, 32767, -32767, 32767, 6067, -3609, 32767, -7877, -32767, 10606, 5286, -17258,
        -10442, -27894, -23136, 567, 3605, 31921, 69, 30783, 338, -2168, -2782, -5548, 1369,
        -32767, -32767, -4568, -9922, 3932, 5581, 2924, -17254, -30789, -9000, -6944, 7855, 28544,
        -25018, 173, 27799, -18367, 1401, -32767, 978, 251, -111, 2627, -12690, 6349, 32767, 4712,
        -3466, 14887, 11411, 17879, -32767, -7114, -3954, -5431, 719, 17135, 6341, -32767, 18521,
        32767, -4781, -3859, 4894, -11146, -23235, 1755, 6540, -31787, 11281, 32718, -5499, -2927,
        32767, 710, -81, 408, -355, -24768, 1925, -7766, 8419, -15607, 23817, -9149, -10226, 1375,
        1292, 14479, -5606, -27135, -11593, 12547, 19294, -734, -10396, 1735, -803, -10627, -22247,
        32767, 13359, 15881, -4687, 32767, 9601, 5712, -4867, -981, -260, 1390, -23554, -9984,
        17504, 7876, 5029, 24042, -1497, 8895, 16726, 11817, 18831, 27043, -5610, 6053, 6654,
        -32767, -13214, -2838, 32767, -11804, 790, 2717, -2621, 1611, -15005, -6938, 1630, 4109,
        -13041, -5716, 21402, 8355, -32767, -2578, -23046, 5452, 13021, 2750, -2561, 27, -8989,
        5033, 32767, 20643, 24461, 7900, 3498, 181, 32767, -119, -8056, 8283, -30512, 3876, -32767,
        17748, -6244, -532, 32767, -17803, 24451, -32767, 18276, 9277, -5870, -11197, -4957,
        -27179, 11370, -6290, 15795, -22806, -26519, -13398, 27961, 7318, -3026, -32767, 32767,
        -1174, -4841, 32767, 22484, 1901, 19307, 14228, -19852, -12929, -32767, -6389, -6461,
        17855, 23520, -5876, -19404, -10636, 290, 7574, 2566, 2005, -11531, -222, -1624, -26220,
        2016, 14345, -10804, -31076, -12322, 3347, -9506, 29896, 32767, 1979, 23562, 5490, 12930,
        -28051, 10309, -1982, -32767, -5600, -19837, -1654, -9813, -20439, -29784, 6145, -18102,
        -18712, -11966, -32767, -4964, 4774, 2890, -12775, -1645, 4516, 21146, 2057, 32767, 5966,
        -11973, 6955, 25874, -3425, 983, 12855, 29725, -9320, 22495, 28241, 15703, 24390, 24651,
        -10896, 16630, 25287, -70, 15809, -4207, 16494, 9764, -17061, 27866, 16023, 11889, 14201,
        -2677, 32767, 21944, 15250, -6668, -10459, 5465, 3960, -6849, 23590, -441, -5417, 23956,
        11879, 7498, 19616, -3898, 27784, -806, 27416, 32767, 2477, 14186, 955, -22066, -354,
        17217, -32767, 32767, -2804, -13741, 12391, -4245, 32767, -15676, -2352, 12736, 12478,
        -9002, -1038, -5097, -9204, -2983, -32767, -32767, 2793, 3595, -32767, 32767, 5642, 1627,
        -32767, -15162, 1586, 13107, -32767, -10142, -32767, -23135, 2708, 4260, -7617, -10572,
        -6147, 3775, -3938, 13040, 1857, -3773, 3102, 5156, 16092, -2442, -13650, -15733, 19404,
        -32767, 15201, -27734, 7815, -19772, -32767, 32767, 16260, 32767, -24078, -32767, 10217,
        17553, 24831, -4918, 16598, 10649, 32767, -17416, 13419, 13166, -23598, 454, 8675, -2093,
        -14054, -12312, -32767, -2001, -5968, -1533, 13510, 2228, 9790, 32767, 1142, -9570, 28225,
        3404, 6666, 8298, -4786, 10092, 11874, -1872, -8558, -6494, -4916, 12430, -15159, -14838,
        2954, -2857, 1281, -6106, 23423, -32767, -5757, -2310, -11180, 32767, 18421, -23485, 26773,
        -14427, -10122, 3702, 13459, -22582, 16885, -347, -22142, -2203, -847, 12047, -2097, 7549,
        -18453, 1682, -1517, -32767, 11985, -13923, -24064, 14533, 543, 22382, 2832,
    ];
    let env = ExecutorEnv::builder()
        .write(&input)
        .unwrap()
        .build()
        .unwrap();

    // Obtain the default prover.
    let prover = default_prover();

    // Proof information by proving the specified ELF binary.
    // This struct contains the receipt along with statistics about execution of the guest
    let prove_info = prover.prove(env, ZKSECURE_GUEST_ELF).unwrap();

    // extract the receipt.
    let receipt = prove_info.receipt;

    // TODO: Implement code for retrieving receipt journal here.

    // For example:
    let _output: u32 = receipt.journal.decode().unwrap();

    // The receipt was verified at the end of proving, but the below code is an
    // example of how someone else could verify this receipt.
    receipt.verify(ZKSECURE_GUEST_ID).unwrap();
}
